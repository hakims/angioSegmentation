#Program to cleanup files/folders generated by the main program.
# example usage: python cleanup.py Data\1009379


import os
import sys
from pathlib import Path
import shutil

def cleanup_generated_files(root_dir):
    print(f"üßπ Cleaning generated files in: {root_dir}")
    for root, dirs, files in os.walk(root_dir):
        path = Path(root)

        # Delete unwanted files
        for name in files:
            if name.endswith((".json", "_cropped.mp4")):
                file_path = path / name
                print(f"  üóëÔ∏è Deleting file: {file_path}")
                file_path.unlink(missing_ok=True)

        # Delete unwanted folders
        for name in dirs:
            if name in {"frames", "masks", "skeletons", "skeletons_raw", "debug", "metadata"}:
                dir_path = path / name
                print(f"  üßπ Removing folder: {dir_path}")
                shutil.rmtree(dir_path, ignore_errors=True)

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python cleanupDrSAM.py <path_to_root_dir>")
        sys.exit(1)

    root_dir = Path(sys.argv[1])
    if not root_dir.exists() or not root_dir.is_dir():
        print(f"‚ùå Invalid directory: {root_dir}")
        sys.exit(1)

    cleanup_generated_files(root_dir)
